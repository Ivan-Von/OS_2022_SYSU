

## 3.1 论述长期调度、中期调度和短期调度的差异

##### 长期调度

​	将已进入系统并处于后备状态的作业按某种算法选择一个或一批，为其建立进程，并进入主机。当该作业执行完毕时，还负责回收系统资源。

##### 中期调度

​	将进程从内存或从CPU竞争中移出，从而降低多道程序设计的程度，之后进程能被重新调入内存，并从中断处继续执行。

##### 短期调度

​	又称为进程调度、低级调度或微观调度。主要任务是按照某种策略和算法将处理机分配给一个处于就绪状态的进程，分为抢占式和非抢占式。

#### 区别：主要区别在于使用的地方和使用频率不一致

##### 短期调度使用频率最高

​	短期调度在内存作业中选择就绪执行的作业，并为他们分配CPU，于是需要多次被调用

##### 中期调度次之

​	中期调度作为一种中等程度的调度程序，主要被用于分时系统，将部分运行程序移出内存，之后，从中断处继续执行。

##### 长期调度最少被调用

​	长期调度确定哪些作业调入内存以执行，并不频繁，可能在进程离开系统时才被唤起。

##### 下图展示了三种调度算法的使用位置的不同

![这里写图片描述](https://img-blog.csdn.net/20151026170356243)

## 3.6 何时到达第 J 行

```c
int pid=fork();
if(pid < 0){
//失败，该用户的进程数达到限制或者内存被用光了
}
else if(pid == 0){
//子进程执行的代码
}
else{
//父进程执行的代码
}
```

#### 所以如果是在子进程中的话会返回pid=0，输出LINE J

![image-20220407213610011](C:\Users\张文沁\AppData\Roaming\Typora\typora-user-images\image-20220407213610011.png)

## 3.7 采用3-32所示的程序，确定行ABCD中的PID值（假定父进程和子进程的PID分别为2600和2603）

A中为0

B中为2603

C中为2603

D中为2600

![image-20220407213811870](C:\Users\张文沁\AppData\Roaming\Typora\typora-user-images\image-20220407213811870.png)

## 3.8 普通管道有时比命名管道更合适，而命名管道有时比普通管道更合适。请举例说明

​	普通管道：用于有血缘关系之间的进程间的通信（PIPE） 且只能是单向通信

​		eg: 隔空投送，广播

​	命名管道：用于任意进程间的通信（FIFO）且可以是双向通信

​		eg: 聊天

​	注：FIFO严格遵循先进先出，对管道及FIFO的读总是从开始处返回数据，写则把数据添加到末尾。不支持seek()等文件定位操作。

## 3.12

![image-20220408163010418](C:\Users\张文沁\AppData\Roaming\Typora\typora-user-images\image-20220408163010418.png)

#### 选择了sleep的方式生成僵尸进程：

```c
#include<stdio.h>
#include<sys/types.h>
#include<unistd.h>
int main(void)
{
    pid_t pid;
    pid = fork();
    if (pid < 0)
	{
		printf("Fork Failed");
	}
    else if (pid == 0)
	{
	    printf("Child process\n");
    }
    else
    {
        printf("Parent Process\n");
        sleep(30);  //父进程休眠30s保证子进程先退出并成为僵尸进程
        printf("Weak up and quit\n");
    }
    return 0;
}
```

#### 刚开始抓取到的僵尸进程：

![image-20220408165843610](C:\Users\张文沁\AppData\Roaming\Typora\typora-user-images\image-20220408165843610.png)

#### 编译zombie.c运行获得的僵尸进程：S+为睡眠状态

##### 	可以清楚地看到 [zombie] 为 Z 状态，即僵尸状态

![image-20220408170008046](C:\Users\张文沁\AppData\Roaming\Typora\typora-user-images\image-20220408170008046.png)

#### 程序结束状态：

![image-20220408170132283](C:\Users\张文沁\AppData\Roaming\Typora\typora-user-images\image-20220408170132283.png)

## 3.20

![image-20220408163017256](C:\Users\张文沁\AppData\Roaming\Typora\typora-user-images\image-20220408163017256.png)

```c
#include <stdio.h>
#include <sys/types.h>
#include <sys/stat.h>
#include <fcntl.h>
#include <unistd.h>
#include <string.h>
#include <sys/mman.h>
#include <sys/ioctl.h>
#include <dirent.h>
#include <linux/input.h>
#include <signal.h>
#include <sys/wait.h>
#include <stdlib.h>
#include <pthread.h>
int main(int argc,char **argv)
{

    char buf[1024] = {0};
    memset(buf, 0, sizeof(buf));    //定义一个字符数组并且清空

    int mk = mkfifo("/tmp/tran",0777);    //创建一个管道
        if(mk == -1)
        {
            printf("establish mk fail.\n");    //判断是否创建有名管道成功
        }

    int fifo = open("/tmp/tran", O_RDWR);    //打开管道

    int fd_src = open(argv[1],O_RDWR);    //打开需要复制的文件
        if(fd_src < 0)
        {
            printf("open %s fail.\n",argv[1]);    //判断是否打开成功
        }

    int fd_desc = open(argv[2],O_CREAT|O_RDWR|O_TRUNC,0777);    //创建新的文件
        if(fd_desc < 0)
        {
            printf("open %s fail.\n",argv[2]);    //判断是否打开成功
        }

    while(1)    //读写文件
    {
        int dre = read(fd_src, buf, sizeof(buf));

        write(fifo, buf, dre);    //从文件中读取文件并且写入管道

        memset(buf, 0, sizeof(buf));

        int re = read(fifo, buf, sizeof(buf));    //从管道中读取文件并且写入新的文件中

        int ret = write(fd_desc, buf, re);

        memset(buf , 0, sizeof(buf));

        if(ret < 1024)    //判断文件是否写入完成，完成则退出。
            break;
    }
    printf("copy succes.\n");
	close(fd_src);	
	close(fd_desc);    //关闭文件
	return 0;
}
```



![image-20220408164134499](C:\Users\张文沁\AppData\Roaming\Typora\typora-user-images\image-20220408164134499.png)



#### 结果：1.txt中写入"hello world" ，运行结束后生成了 2 内容也为 "hello world"

![image-20220408164359604](C:\Users\张文沁\AppData\Roaming\Typora\typora-user-images\image-20220408164359604.png)

![image-20220408164320776](C:\Users\张文沁\AppData\Roaming\Typora\typora-user-images\image-20220408164320776.png)